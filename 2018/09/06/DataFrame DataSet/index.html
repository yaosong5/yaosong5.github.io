<!DOCTYPE html>
<html lang=zh>
<head>
    <meta name="baidu-site-verification"content="WHXmBFaAkY"/>
    <meta name="google-site-verification" content="vDyi3jVPymP4jOpfzY4F1zG4-FXD1T-A5unnDJuNxhs" />
    <meta charset="utf-8">
    

    <title>DataStream DataSetä»‹ç» | é’¢é“é”…</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="[TOC] ä»€ä¹ˆæ˜¯DataStreamDiscretized Streamæ˜¯Spark Streamingçš„åŸºç¡€æŠ½è±¡ï¼Œä»£è¡¨æŒç»­æ€§çš„æ•°æ®æµå’Œç»è¿‡å„ç§SparkåŸè¯­æ“ä½œåçš„ç»“æœæ•°æ®æµã€‚åœ¨å†…éƒ¨å®ç°ä¸Šï¼ŒDStreamæ˜¯ä¸€ç³»åˆ—è¿ç»­çš„RDDæ¥è¡¨ç¤ºã€‚æ¯ä¸ªRDDå«æœ‰ä¸€æ®µæ—¶é—´é—´éš”å†…çš„æ•°æ®ï¼Œå¦‚ä¸‹å›¾ï¼š ä¸RDDç±»ä¼¼ï¼ŒDataFrameä¹Ÿæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®å®¹å™¨ã€‚ç„¶è€ŒDataFrameæ›´åƒä¼ ç»Ÿæ•°æ®åº“çš„äºŒç»´è¡¨æ ¼ï¼Œé™¤äº†æ•°æ®ä»¥å¤–ï¼Œ">
<meta name="keywords" content="Spark">
<meta property="og:type" content="article">
<meta property="og:title" content="DataStream DataSetä»‹ç»">
<meta property="og:url" content="http://gangtieguo.cn/2018/09/06/DataFrame DataSet/index.html">
<meta property="og:site_name" content="é’¢é“é”…">
<meta property="og:description" content="[TOC] ä»€ä¹ˆæ˜¯DataStreamDiscretized Streamæ˜¯Spark Streamingçš„åŸºç¡€æŠ½è±¡ï¼Œä»£è¡¨æŒç»­æ€§çš„æ•°æ®æµå’Œç»è¿‡å„ç§SparkåŸè¯­æ“ä½œåçš„ç»“æœæ•°æ®æµã€‚åœ¨å†…éƒ¨å®ç°ä¸Šï¼ŒDStreamæ˜¯ä¸€ç³»åˆ—è¿ç»­çš„RDDæ¥è¡¨ç¤ºã€‚æ¯ä¸ªRDDå«æœ‰ä¸€æ®µæ—¶é—´é—´éš”å†…çš„æ•°æ®ï¼Œå¦‚ä¸‹å›¾ï¼š ä¸RDDç±»ä¼¼ï¼ŒDataFrameä¹Ÿæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®å®¹å™¨ã€‚ç„¶è€ŒDataFrameæ›´åƒä¼ ç»Ÿæ•°æ®åº“çš„äºŒç»´è¡¨æ ¼ï¼Œé™¤äº†æ•°æ®ä»¥å¤–ï¼Œ">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://pebgsxjpj.bkt.clouddn.com/15360627803806.jpg">
<meta property="og:image" content="http://pebgsxjpj.bkt.clouddn.com/15360627860827.jpg">
<meta property="og:image" content="http://pebgsxjpj.bkt.clouddn.com/15360627909583.jpg">
<meta property="og:image" content="http://pebgsxjpj.bkt.clouddn.com/15360698161149.jpg">
<meta property="og:image" content="http://pebgsxjpj.bkt.clouddn.com/15360679610176.jpg">
<meta property="og:image" content="http://pebgsxjpj.bkt.clouddn.com/15360681467801.jpg">
<meta property="og:updated_time" content="2018-09-05T17:27:07.061Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DataStream DataSetä»‹ç»">
<meta name="twitter:description" content="[TOC] ä»€ä¹ˆæ˜¯DataStreamDiscretized Streamæ˜¯Spark Streamingçš„åŸºç¡€æŠ½è±¡ï¼Œä»£è¡¨æŒç»­æ€§çš„æ•°æ®æµå’Œç»è¿‡å„ç§SparkåŸè¯­æ“ä½œåçš„ç»“æœæ•°æ®æµã€‚åœ¨å†…éƒ¨å®ç°ä¸Šï¼ŒDStreamæ˜¯ä¸€ç³»åˆ—è¿ç»­çš„RDDæ¥è¡¨ç¤ºã€‚æ¯ä¸ªRDDå«æœ‰ä¸€æ®µæ—¶é—´é—´éš”å†…çš„æ•°æ®ï¼Œå¦‚ä¸‹å›¾ï¼š ä¸RDDç±»ä¼¼ï¼ŒDataFrameä¹Ÿæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®å®¹å™¨ã€‚ç„¶è€ŒDataFrameæ›´åƒä¼ ç»Ÿæ•°æ®åº“çš„äºŒç»´è¡¨æ ¼ï¼Œé™¤äº†æ•°æ®ä»¥å¤–ï¼Œ">
<meta name="twitter:image" content="http://pebgsxjpj.bkt.clouddn.com/15360627803806.jpg">
    

    

    
        <link rel="icon" href="/css/images/Basketball-icon.png" />
    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/open-sans/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.1.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
    
    
        <script>
var _hmt = _hmt || [];
(function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?e304a23572827f3ea779e13779ddb9b6";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
})();
</script>

    


     <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?e304a23572827f3ea779e13779ddb9b6";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


</head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">é’¢é“é”…</span>
            </a>
            <nav id="main-nav">
            <a class="main-nav-link" href="/."><i class="fa fa-home"></i>ä¸»é¡µ</a>
            <a class="main-nav-link" href="/archives"><i class="fa fa-archive"></i>å½’æ¡£</a>
            <a class="main-nav-link" href="/categories"><i class="fa fa-folder"></i>åˆ†ç±»</a>
            <a class="main-nav-link" href="/tags"><i class="fa fa-tags"></i>æ ‡ç­¾</a>
            <a class="main-nav-link" href="/about"><i class="fa fa-user"></i>å…³äº</a>

               <!--   -->
               <!--     <a class="main-nav-link" href="/.">  -->
               <!--     <i class="fa fa-home"></i>  -->
               <!--     ä¸»é¡µ  -->
               <!--     </a>  -->
               <!--   -->
               <!--     <a class="main-nav-link" href="/archives">  -->
               <!--     <i class="fa fa-home"></i>  -->
               <!--     å½’æ¡£  -->
               <!--     </a>  -->
               <!--   -->
               <!--     <a class="main-nav-link" href="/categories">  -->
               <!--     <i class="fa fa-home"></i>  -->
               <!--     åˆ†ç±»  -->
               <!--     </a>  -->
               <!--   -->
               <!--     <a class="main-nav-link" href="/tags">  -->
               <!--     <i class="fa fa-home"></i>  -->
               <!--     æ ‡ç­¾  -->
               <!--     </a>  -->
               <!--   -->
               <!--     <a class="main-nav-link" href="/about">  -->
               <!--     <i class="fa fa-home"></i>  -->
               <!--     å…³äº  -->
               <!--     </a>  -->
               <!--   -->

            </nav>
            
                
                <nav id="sub-nav">
                    <div class="profile" id="profile-nav">
                        <a id="profile-anchor" href="javascript:;">
                            <img class="avatar" src="/css/images/venum.gif" />
                            <i class="fa fa-caret-down"></i>
                        </a>
                    </div>
                </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="æœç´¢" />
         <!-- <button type="submit" class="search-form-submit"></button> -->
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'æ–‡ç« ',
            PAGES: 'é¡µé¢',
            CATEGORIES: 'åˆ†ç±»',
            TAGS: 'æ ‡ç­¾',
            UNTITLED: '(æœªå‘½å)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/.">ä¸»é¡µ</a></td>
                
                    <td><a class="main-nav-link" href="/archives">å½’æ¡£</a></td>
                
                    <td><a class="main-nav-link" href="/categories">åˆ†ç±»</a></td>
                
                    <td><a class="main-nav-link" href="/tags">æ ‡ç­¾</a></td>
                
                    <td><a class="main-nav-link" href="/about">å…³äº</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="æœç´¢" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
             

                

<aside id="profile" class="profile-fixed">
    <div class="inner profile-inner">
        <div class="base-info profile-block">
            <img id="avatar" src="/css/images/venum.gif" />
            <h2 id="name">GTG</h2>
            <h3 id="title">Nothing</h3>
            <span id="location"><i class="fa fa-map-marker"></i>å››æµ·ä¸ºå®¶</span>
           
        </div>
      <div class="article-info profile-block">
            <div class="article-info-block">
                61
                <span>æ–‡ç« </span>
            </div>
            <div class="article-info-block">
                44
                <span>æ ‡ç­¾</span>
            </div>
        </div>
        
        <div class="profile-block social-links">
            <table>
                <tr>
                    
                    
                    <td>
                        <a href="https://github.com/yaosong5" target="_blank" title="github" class=tooltip>
                            <i class="fa fa-github"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="https://weibo.com/gangtieguo/" target="_blank" title="weibo" class=tooltip>
                            <i class="fa fa-weibo"></i>
                        </a>
                    </td>
                    
                </tr>
            </table>
        </div>

        
        
    </div>


</aside>


            

            <section id="main"><article id="post-DataFrame DataSet" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
            DataStream DataSetä»‹ç»
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2018/09/06/DataFrame DataSet/">
            <time datetime="2018-09-05T17:20:33.287Z" itemprop="datePublished">2018-09-06</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/å¤§æ•°æ®/">å¤§æ•°æ®</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Spark/">Spark</a>
    </div>

                    </div>
                
            </header>
        
       
        
        <div class="article-entry" itemprop="articleBody">
        
            




            <p class="show-toc-btn hidden" id="show-toc-btn" onclick="showToc();">
                    <i class="fa fa-align-justify" aria-hidden="true"></i>
                    <span class="btn-text"> æ–‡ç« ç›®å½•</span>
            </p>


            <div id="toc toc-article "  class="toc-article">
                <span id="toc-close" class="toc-close" title="éšè—ç›®å½•" onclick="showBtn();"><i class="fa fa-times" aria-hidden="true"></i></span>
                <strong class="toc-title">ç›®å½•</strong>
                <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ä»€ä¹ˆæ˜¯DataStream"><span class="toc-number">1.</span> <span class="toc-text">ä»€ä¹ˆæ˜¯DataStream</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DataStreamç›¸å…³æ“ä½œ"><span class="toc-number">2.</span> <span class="toc-text">DataStreamç›¸å…³æ“ä½œ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Transformations-on-DStreams"><span class="toc-number">2.1.</span> <span class="toc-text">Transformations on DStreams</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ç‰¹æ®Šçš„Transformations"><span class="toc-number">2.1.1.</span> <span class="toc-text">ç‰¹æ®Šçš„Transformations</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Output-Operations-on-DStreams"><span class="toc-number">2.2.</span> <span class="toc-text">Output Operations on DStreams</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ç”¨Spark-Streamingå®ç°å®æ—¶WordCount"><span class="toc-number">2.3.</span> <span class="toc-text">ç”¨Spark Streamingå®ç°å®æ—¶WordCount</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Dataset"><span class="toc-number">3.</span> <span class="toc-text">Dataset</span></a></li></ol>
            </div>


            
            <script type="text/javascript">
                            function showBtn(){
                             if($('.toc-article').hasClass('hidden')){
                                    $('.toc-article').removeClass('hidden');
                                }else{
                                    $('.toc-article').addClass('hidden');
                                }
                                 $('.show-toc-btn').removeClass('hidden');  
                            };
                            function showToc(){
                              if($('.show-toc-btn').hasClass('hidden')){
                                      $('.show-toc-btn').removeClass('hidden');


                                  }else{
                                      $('.show-toc-btn').addClass('hidden');

                                  }
                                   $('.toc-article').removeClass('hidden');
                            };
             </script>

                <p>[TOC]</p>
<h1 id="ä»€ä¹ˆæ˜¯DataStream"><a href="#ä»€ä¹ˆæ˜¯DataStream" class="headerlink" title="ä»€ä¹ˆæ˜¯DataStream"></a>ä»€ä¹ˆæ˜¯DataStream</h1><p>Discretized Streamæ˜¯Spark Streamingçš„åŸºç¡€æŠ½è±¡ï¼Œä»£è¡¨æŒç»­æ€§çš„æ•°æ®æµå’Œç»è¿‡å„ç§SparkåŸè¯­æ“ä½œåçš„ç»“æœæ•°æ®æµã€‚åœ¨å†…éƒ¨å®ç°ä¸Šï¼ŒDStreamæ˜¯ä¸€ç³»åˆ—è¿ç»­çš„RDDæ¥è¡¨ç¤ºã€‚æ¯ä¸ªRDDå«æœ‰ä¸€æ®µæ—¶é—´é—´éš”å†…çš„æ•°æ®ï¼Œå¦‚ä¸‹å›¾ï¼š<br><img src="http://pebgsxjpj.bkt.clouddn.com/15360627803806.jpg" alt=""></p>
<p>ä¸RDDç±»ä¼¼ï¼ŒDataFrameä¹Ÿæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®å®¹å™¨ã€‚ç„¶è€ŒDataFrameæ›´åƒä¼ ç»Ÿæ•°æ®åº“çš„äºŒç»´è¡¨æ ¼ï¼Œé™¤äº†æ•°æ®ä»¥å¤–ï¼Œè¿˜è®°å½•æ•°æ®çš„ç»“æ„ä¿¡æ¯ï¼Œå³schemaã€‚åŒæ—¶ï¼Œä¸Hiveç±»ä¼¼ï¼ŒDataFrameä¹Ÿæ”¯æŒåµŒå¥—æ•°æ®ç±»å‹ï¼ˆstructã€arrayå’Œmapï¼‰ã€‚ä»APIæ˜“ç”¨æ€§çš„è§’åº¦ä¸Š çœ‹ï¼ŒDataFrame APIæä¾›çš„æ˜¯ä¸€å¥—é«˜å±‚çš„å…³ç³»æ“ä½œï¼Œæ¯”å‡½æ•°å¼çš„RDD APIè¦æ›´åŠ å‹å¥½ï¼Œé—¨æ§›æ›´ä½ã€‚ç”±äºä¸Rå’ŒPandasçš„DataFrameç±»ä¼¼ï¼ŒSpark DataFrameå¾ˆå¥½åœ°ç»§æ‰¿äº†ä¼ ç»Ÿå•æœºæ•°æ®åˆ†æçš„å¼€å‘ä½“éªŒã€‚</p>
<p>å¯¹æ•°æ®çš„æ“ä½œä¹Ÿæ˜¯æŒ‰ç…§RDDä¸ºå•ä½æ¥è¿›è¡Œçš„<br><img src="http://pebgsxjpj.bkt.clouddn.com/15360627860827.jpg" alt=""></p>
<p>è®¡ç®—è¿‡ç¨‹ç”±Spark engineæ¥å®Œæˆ<br><img src="http://pebgsxjpj.bkt.clouddn.com/15360627909583.jpg" alt=""></p>
<p>Datasets ä¸DataFrames ä¸RDDsçš„å…³ç³»<br><img src="http://pebgsxjpj.bkt.clouddn.com/15360698161149.jpg" alt=""></p>
<p>Sparkå¼•å…¥DataFrameï¼Œå®ƒå¯ä»¥æä¾›high-level functionsè®©Sparkæ›´å¥½çš„å¤„ç†ç»“æ„æ•°æ®çš„è®¡ç®—ã€‚è¿™è®©Catalyst optimizer å’ŒTungstenï¼ˆé’¨ä¸ï¼‰ execution engineè‡ªåŠ¨åŠ é€Ÿå¤§æ•°æ®åˆ†æã€‚<br>å‘å¸ƒDataFrameä¹‹åå¼€å‘è€…æ”¶åˆ°äº†å¾ˆå¤šåé¦ˆï¼Œå…¶ä¸­ä¸€ä¸ªä¸»è¦çš„æ˜¯å¤§å®¶åæ˜ ç¼ºä¹ç¼–è¯‘æ—¶ç±»å‹å®‰å…¨ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒSparké‡‡ç”¨æ–°çš„Dataset API (DataFrame APIçš„ç±»å‹æ‰©å±•)ã€‚<br>Dataset APIæ‰©å±•DataFrame APIæ”¯æŒé™æ€ç±»å‹å’Œè¿è¡Œå·²ç»å­˜åœ¨çš„Scalaæˆ–Javaè¯­è¨€çš„ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ã€‚å¯¹æ¯”ä¼ ç»Ÿçš„RDD APIï¼ŒDataset APIæä¾›æ›´å¥½çš„å†…å­˜ç®¡ç†ï¼Œç‰¹åˆ«æ˜¯åœ¨é•¿ä»»åŠ¡ä¸­æœ‰æ›´å¥½çš„æ€§èƒ½æå‡</p>
<h1 id="DataStreamç›¸å…³æ“ä½œ"><a href="#DataStreamç›¸å…³æ“ä½œ" class="headerlink" title="DataStreamç›¸å…³æ“ä½œ"></a>DataStreamç›¸å…³æ“ä½œ</h1><p>DStreamä¸Šçš„åŸè¯­ä¸RDDçš„ç±»ä¼¼ï¼Œåˆ†ä¸ºTransformationsï¼ˆè½¬æ¢ï¼‰å’ŒOutputOperationsï¼ˆè¾“å‡ºï¼‰ä¸¤ç§ï¼Œæ­¤å¤–è½¬æ¢æ“ä½œä¸­è¿˜æœ‰ä¸€äº›æ¯”è¾ƒç‰¹æ®Šçš„åŸè¯­ï¼Œå¦‚ï¼šupdateStateByKey()ã€transform()ä»¥åŠå„ç§Windowç›¸å…³çš„åŸè¯­ã€‚</p>
<h2 id="Transformations-on-DStreams"><a href="#Transformations-on-DStreams" class="headerlink" title="Transformations on DStreams"></a>Transformations on DStreams</h2><table>
<thead>
<tr>
<th>Transformation</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>map(func)</td>
<td>Return a new DStream by passing each  element of the source DStream through a function func.</td>
</tr>
<tr>
<td>flatMap(func)</td>
<td>Similar to map, but each input item can  be mapped to 0 or more output items.</td>
</tr>
<tr>
<td>filter(func)</td>
<td>Return a new DStream by selecting only  the records of the source DStream on which func returns true.</td>
</tr>
<tr>
<td>repartition(numPartitions)</td>
<td>Changes the level of parallelism in this  DStream by creating more or fewer partitions.</td>
</tr>
<tr>
<td>union(otherStream)</td>
<td>Return a new DStream that contains the  union of the elements in the source DStream and otherDStream.</td>
</tr>
<tr>
<td>count()</td>
<td>Return a new DStream of single-element  RDDs by counting the number of elements in each RDD of the source DStream.</td>
</tr>
<tr>
<td>reduce(func)</td>
<td>Return a new DStream of single-element  RDDs by aggregating the elements in each RDD of the source DStream using a  function func (which takes two arguments and returns one). The function  should be associative so that it can be computed in parallel.</td>
</tr>
<tr>
<td>countByValue()</td>
<td>When called on a DStream of elements of  type K, return a new DStream of (K, Long) pairs where the value of each key  is its frequency in each RDD of the source DStream.</td>
</tr>
<tr>
<td>reduceByKey(func, [numTasks])</td>
<td>When called on a DStream of (K, V) pairs,  return a new DStream of (K, V) pairs where the values for each key are  aggregated using the given reduce function. Note: By default, this uses Sparkâ€™s  default number of parallel tasks (2 for local mode, and in cluster mode the  number is determined by the config property spark.default.parallelism) to do  the grouping. You can pass an optional numTasks argument to set a different  number of tasks.</td>
</tr>
<tr>
<td>join(otherStream, [numTasks])</td>
<td>When called on two DStreams of (K, V) and  (K, W) pairs, return a new DStream of (K, (V, W)) pairs with all pairs of  elements for each key.</td>
</tr>
<tr>
<td>cogroup(otherStream, [numTasks])</td>
<td>When called on a DStream of (K, V) and  (K, W) pairs, return a new DStream of (K, Seq[V], Seq[W]) tuples.</td>
</tr>
<tr>
<td>transform(func)</td>
<td>Return a new DStream by applying a  RDD-to-RDD function to every RDD of the source DStream. This can be used to  do arbitrary RDD operations on the DStream.</td>
</tr>
<tr>
<td>updateStateByKey(func)</td>
<td>Return a new â€œstateâ€ DStream  where the state for each key is updated by applying the given function on the  previous state of the key and the new values for the key. This can be used to  maintain arbitrary state data for each key.</td>
</tr>
</tbody>
</table>
<h3 id="ç‰¹æ®Šçš„Transformations"><a href="#ç‰¹æ®Šçš„Transformations" class="headerlink" title="ç‰¹æ®Šçš„Transformations"></a>ç‰¹æ®Šçš„Transformations</h3><ol>
<li>UpdateStateByKeyOperation</li>
</ol>
<p>UpdateStateByKeyåŸè¯­ç”¨äºè®°å½•å†å²è®°å½•ï¼Œä¸Šæ–‡ä¸­Word Countç¤ºä¾‹ä¸­å°±ç”¨åˆ°äº†è¯¥ç‰¹æ€§ã€‚è‹¥ä¸ç”¨UpdateStateByKeyæ¥æ›´æ–°çŠ¶æ€ï¼Œé‚£ä¹ˆæ¯æ¬¡æ•°æ®è¿›æ¥ååˆ†æå®Œæˆåï¼Œç»“æœè¾“å‡ºåå°†ä¸åœ¨ä¿å­˜</p>
<ol>
<li>TransformOperation</li>
</ol>
<p>TransformåŸè¯­å…è®¸DStreamä¸Šæ‰§è¡Œä»»æ„çš„RDD-to-RDDå‡½æ•°ã€‚é€šè¿‡è¯¥å‡½æ•°å¯ä»¥æ–¹ä¾¿çš„æ‰©å±•Spark APIã€‚æ­¤å¤–ï¼ŒMLlibï¼ˆæœºå™¨å­¦ä¹ ï¼‰ä»¥åŠGraphxä¹Ÿæ˜¯é€šè¿‡æœ¬å‡½æ•°æ¥è¿›è¡Œç»“åˆçš„ã€‚</p>
<ol>
<li>WindowOperations</li>
</ol>
<p>Window Operationsæœ‰ç‚¹ç±»ä¼¼äºStormä¸­çš„Stateï¼Œå¯ä»¥è®¾ç½®çª—å£çš„å¤§å°å’Œæ»‘åŠ¨çª—å£çš„é—´éš”æ¥åŠ¨æ€çš„è·å–å½“å‰Steamingçš„å…è®¸çŠ¶æ€<br><img src="http://pebgsxjpj.bkt.clouddn.com/15360679610176.jpg" alt=""></p>
<h2 id="Output-Operations-on-DStreams"><a href="#Output-Operations-on-DStreams" class="headerlink" title="Output Operations on DStreams"></a>Output Operations on DStreams</h2><p>Output Operationså¯ä»¥å°†DStreamçš„æ•°æ®è¾“å‡ºåˆ°å¤–éƒ¨çš„æ•°æ®åº“æˆ–æ–‡ä»¶ç³»ç»Ÿï¼Œå½“æŸä¸ªOutput OperationsåŸè¯­è¢«è°ƒç”¨æ—¶ï¼ˆä¸RDDçš„Actionç›¸åŒï¼‰ï¼Œstreamingç¨‹åºæ‰ä¼šå¼€å§‹çœŸæ­£çš„è®¡ç®—è¿‡ç¨‹ã€‚</p>
<table>
<thead>
<tr>
<th>Output Operation</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>print()</td>
<td>Prints the first ten elements of every  batch of data in a DStream on the driver node running the streaming  application. This is useful for development and debugging.</td>
</tr>
<tr>
<td>saveAsTextFiles(prefix, [suffix])</td>
<td>Save this DStreamâ€™s contents as text  files. The file name at each batch interval is generated based on prefix and  suffix: â€œprefix-TIME_IN_MS[.suffix]â€.</td>
</tr>
<tr>
<td>saveAsObjectFiles(prefix, [suffix])</td>
<td>Save this DStreamâ€™s contents as  SequenceFiles of serialized Java objects. The file name at each batch  interval is generated based on prefix and suffix:  â€œprefix-TIME_IN_MS[.suffix]â€.</td>
</tr>
<tr>
<td>saveAsHadoopFiles(prefix, [suffix])</td>
<td>Save this DStreamâ€™s contents as Hadoop  files. The file name at each batch interval is generated based on prefix and  suffix: â€œprefix-TIME_IN_MS[.suffix]â€.</td>
</tr>
<tr>
<td>foreachRDD(func)</td>
<td>The most generic output operator that  applies a function, func, to each RDD generated from the stream. This  function should push the data in each RDD to an external system, such as  saving the RDD to files, or writing it over the network to a database. Note  that the function func is executed in the driver process running the  streaming application, and will usually have RDD actions in it that will  force the computation of the streaming RDDs.</td>
</tr>
</tbody>
</table>
<h2 id="ç”¨Spark-Streamingå®ç°å®æ—¶WordCount"><a href="#ç”¨Spark-Streamingå®ç°å®æ—¶WordCount" class="headerlink" title="ç”¨Spark Streamingå®ç°å®æ—¶WordCount"></a>ç”¨Spark Streamingå®ç°å®æ—¶WordCount</h2><p>æ¶æ„å›¾ï¼š</p>
<p><img src="http://pebgsxjpj.bkt.clouddn.com/15360681467801.jpg" alt=""></p>
<p>1.å®‰è£…å¹¶å¯åŠ¨ç”Ÿæˆè€…</p>
<p>é¦–å…ˆåœ¨ä¸€å°Linuxï¼ˆipï¼š192.168.10.101ï¼‰ä¸Šç”¨YUMå®‰è£…ncå·¥å…·</p>
<p>yum install -y nc</p>
<p>å¯åŠ¨ä¸€ä¸ªæœåŠ¡ç«¯å¹¶ç›‘å¬9999ç«¯å£</p>
<p>nc -lk 9999</p>
<p>2.ç¼–å†™Spark Streamingç¨‹åº</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> me.yao.spark.streaming</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.<span class="type">SparkConf</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.streaming.&#123;<span class="type">Seconds</span>, <span class="type">StreamingContext</span>&#125;</span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">NetworkWordCount</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]) &#123;       <span class="comment">//è®¾ç½®æ—¥å¿—çº§åˆ«</span></span><br><span class="line">        <span class="type">LoggerLevel</span>.setStreamingLogLevels()    <span class="comment">//åˆ›å»ºSparkConfå¹¶è®¾ç½®ä¸ºæœ¬åœ°æ¨¡å¼è¿è¡Œ   //æ³¨æ„local[2]ä»£è¡¨å¼€ä¸¤ä¸ªçº¿ç¨‹</span></span><br><span class="line">    <span class="keyword">val</span> conf = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">"local[2]"</span>).setAppName(<span class="string">"NetworkWordCount"</span>)    <span class="comment">//è®¾ç½®DStreamæ‰¹æ¬¡æ—¶é—´é—´éš”ä¸º2ç§’</span></span><br><span class="line">    <span class="keyword">val</span> ssc = <span class="keyword">new</span> <span class="type">StreamingContext</span>(conf, <span class="type">Seconds</span>(<span class="number">2</span>))    <span class="comment">//é€šè¿‡ç½‘ç»œè¯»å–æ•°æ®</span></span><br><span class="line">    <span class="keyword">val</span> lines = ssc.socketTextStream(<span class="string">"192.168.10.101"</span>, <span class="number">9999</span>)   <span class="comment">//å°†è¯»åˆ°çš„æ•°æ®ç”¨ç©ºæ ¼åˆ‡æˆå•è¯</span></span><br><span class="line">    <span class="keyword">val</span> words = lines.flatMap(_.split(<span class="string">" "</span>))    <span class="comment">//å°†å•è¯å’Œ1ç»„æˆä¸€ä¸ªpair</span></span><br><span class="line">    <span class="keyword">val</span> pairs = words.map(word =&gt; (word, <span class="number">1</span>))    <span class="comment">//æŒ‰å•è¯è¿›è¡Œåˆ†ç»„æ±‚ç›¸åŒå•è¯å‡ºç°çš„æ¬¡æ•°</span></span><br><span class="line">    <span class="keyword">val</span> wordCounts = pairs.reduceByKey(_ + _)    <span class="comment">//æ‰“å°ç»“æœåˆ°æ§åˆ¶å°</span></span><br><span class="line">    wordCounts.print()    <span class="comment">//å¼€å§‹è®¡ç®—</span></span><br><span class="line">    ssc.start()    <span class="comment">//ç­‰å¾…åœæ­¢</span></span><br><span class="line">    ssc.awaitTermination()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>é—®é¢˜ï¼šç»“æœæ¯æ¬¡åœ¨Linuxç«¯è¾“å…¥çš„å•è¯æ¬¡æ•°éƒ½è¢«æ­£ç¡®çš„ç»Ÿè®¡å‡ºæ¥ï¼Œä½†æ˜¯ç»“æœä¸èƒ½ç´¯åŠ ï¼å¦‚æœéœ€è¦ç´¯åŠ éœ€è¦ä½¿ç”¨updateStateByKey(func)æ¥æ›´æ–°çŠ¶æ€ï¼Œä¸‹é¢ç»™å‡ºä¸€ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">package</span> me.yao.spark.streaming</span><br><span class="line"></span><br><span class="line">  <span class="keyword">import</span> org.apache.spark.&#123;<span class="type">HashPartitioner</span>, <span class="type">SparkConf</span>&#125;</span><br><span class="line">  <span class="keyword">import</span> org.apache.spark.streaming.&#123;<span class="type">StreamingContext</span>, <span class="type">Seconds</span>&#125;</span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">object</span> <span class="title">NetworkUpdateStateWordCount</span> </span>&#123;</span><br><span class="line">  <span class="keyword">val</span> updateFunc = (iter: <span class="type">Iterator</span>[(<span class="type">String</span>, <span class="type">Seq</span>[<span class="type">Int</span>], <span class="type">Option</span>[<span class="type">Int</span>])]) =&gt; &#123;</span><br><span class="line">          <span class="comment">//iter.flatMap(it=&gt;Some(it._2.sum + it._3.getOrElse(0)).map(x=&gt;(it._1,x)))</span></span><br><span class="line">            iter.flatMap&#123;</span><br><span class="line">             <span class="keyword">case</span>(x,y,z)=&gt;<span class="type">Some</span>(y.sum + z.getOrElse(<span class="number">0</span>)).map(m=&gt;(x, m))&#125;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]) &#123;</span><br><span class="line">    <span class="type">LoggerLevel</span>.setStreamingLogLevels*()</span><br><span class="line">    <span class="keyword">val</span> conf = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">"local[2]"</span>).setAppName(<span class="string">"NetworkUpdateStateWordCount"</span>)</span><br><span class="line">    <span class="keyword">val</span> ssc = <span class="keyword">new</span> <span class="type">StreamingContext</span>(conf, <span class="type">Seconds</span>(<span class="number">5</span>))</span><br><span class="line">    <span class="comment">//åšcheckpoint å†™å…¥å…±äº«å­˜å‚¨ä¸­</span></span><br><span class="line">    ssc.checkpoint(<span class="string">"c://aaa"</span>)</span><br><span class="line">    **<span class="keyword">val</span> **lines = ssc.socketTextStream(<span class="string">"192.168.10.100"</span>, <span class="number">9999</span>)</span><br><span class="line">    <span class="comment">//reduceByKey **ç»“æœä¸ç´¯åŠ </span></span><br><span class="line">    <span class="comment">//val result = lines.flatMap(_.split(" ")).map((_, 1)).reduceByKey(_+_)</span></span><br><span class="line">    <span class="comment">//updateStateByKeyç»“æœå¯ä»¥ç´¯åŠ ä½†æ˜¯éœ€è¦ä¼ å…¥ä¸€ä¸ªè‡ªå®šä¹‰çš„ç´¯åŠ å‡½æ•°ï¼šupdateFunc</span></span><br><span class="line">   <span class="keyword">val</span> results = lines.flatMap(_.split(<span class="string">" "</span>)).map((_,<span class="number">1</span>)).updateStateByKey(updateFunc, <span class="keyword">new</span> <span class="type">HashPartitioner</span>(ssc.sparkContext.defaultParallelism), <span class="literal">true</span>)</span><br><span class="line">    results.print()</span><br><span class="line">    ssc.start()</span><br><span class="line">    ssc.awaitTermination()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Dataset"><a href="#Dataset" class="headerlink" title="Dataset"></a>Dataset</h1><p>æ¯”RDDæ‰§è¡Œé€Ÿåº¦å¿«å¾ˆå¤šå€ï¼Œå ç”¨çš„å†…å­˜æ›´å°ï¼Œæ˜¯ä»dataFrameå‘å±•è€Œæ¥ï¼ŒåŒ…å«dataFrame<br>dataFrameæ˜¯å¤„ç†ç»“æ„åŒ–æ•°æ®ï¼Œæœ‰è¡¨å¤´ï¼Œæœ‰ç±»å‹ï¼Œ</p>
<p>dataSetä»1.6.0å¼€å§‹å‡ºç°ï¼Œ2.0åšäº†é‡å¤§æ”¹è¿›ï¼Œå¯¹dataFrameè¿›è¡Œäº†æ•´åˆ<br>dataFrameåœ¨1.4ç³»åˆ—å‡ºç°çš„ï¼Œç°åœ¨å¾ˆå¤šå…¬å¸éƒ½æ˜¯ç”¨çš„RDD</p>
<p>åœ¨sparkçš„å‘½ä»¤è¡Œé‡Œé¢ï¼š<br>å°†dataFrameè½¬æˆdataSet<br>val ds = df.as[person]<br>è°ƒç”¨dataSetçš„æ–¹æ³• </p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ds.map </span><br><span class="line">ds.show </span><br><span class="line"><span class="keyword">val</span> ds = sqlContext.read.text(<span class="string">"hdfs://bigdata1:9000/wc/).as[String] </span></span><br><span class="line"><span class="string">val res5 = ds.flatmap(.split("</span> <span class="string">")).map((,1))</span></span><br></pre></td></tr></table></figure>
<p>flatmapå°†æ–‡æœ¬é‡Œé¢çš„æ¯ä¸€è¡Œè¿›è¡Œåˆ‡åˆ†ï¼Œ<br>rest.reduceByKey();ä¼šå‘ç°dataSeté‡Œé¢æ²¡æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œåœ¨dataSeté‡Œé¢åº”è¯¥è°ƒç”¨æ›´é«˜çº§çš„åšæ³•<br>ds.flatmap(_.split(â€œ â€œ)).groupBy($â€â€value).count.show æˆ–è€…collect</p>
<p>åœ¨importé‡Œé¢æ‰“å¼€ideaæŸ¥çœ‹ç±»é‡Œé¢æœ‰å“ªäº›æ–¹æ³•ã€‚<br>åœ¨spark1.6é‡Œé¢sqlContext.readâ€¦.è¯»å–çš„å°±æ˜¯dataFrameï¼Œå’ŒdataSetè¿˜æœªç»Ÿä¸€ï¼Œéœ€è¦å°†dataFrameç”¨asè½¬ä¸ºdataSet</p>

            

        </div>

        <footer class="article-footer">

        
        <! -- æ·»åŠ æèµ å›¾æ ‡ -->
<div class ="post-donate">
    <div id="donate_board" class="donate_bar center">
        <a id="btn_donate" class="btn_donate" href="javascript:;" title="æ‰“èµ"></a>
        <span class="donate_txt">
           å¦‚æœæ‚¨è§‰å¾—æ–‡ç« ä¸é”™ï¼Œå°±è¯·æˆ‘çœ‹åœºufcç›´æ’­ğŸ¤“ğŸ¤“ğŸ¤“ğŸ¤“ğŸ¤“ï¼
        </span>
        <br>
      </div>  
    <div id="donate_guide" class="donate_bar center hidden" >
        <!-- æ”¯ä»˜å®æ‰“èµå›¾æ¡ˆ -->
        <img src="/css/images/alipay.jpg" alt="æ”¯ä»˜å®æ‰“èµ" > 
        <!-- å¾®ä¿¡æ‰“èµå›¾æ¡ˆ -->
        <img src="/css/images/wechatpay.jpg" alt="å¾®ä¿¡æ‰“èµ" >  
    </div>
    <script type="text/javascript">
        document.getElementById('btn_donate').onclick = function(){
            if($('#donate_guide').hasClass('hidden')){
                $('#donate_guide').removeClass('hidden');
            }else{
                $('#donate_guide').addClass('hidden');
            }
        }
    </script>
</div>
<! -- æ·»åŠ æèµ å›¾æ ‡ -->
        
            <div class="share-container">


    <div class="bdsharebuttonbox">
    <a href="#" class="bds_more" data-cmd="more">åˆ†äº«åˆ°ï¼š</a>
    <a href="#" class="bds_qzone" data-cmd="qzone" title="åˆ†äº«åˆ°QQç©ºé—´">QQç©ºé—´</a>
    <a href="#" class="bds_tsina" data-cmd="tsina" title="åˆ†äº«åˆ°æ–°æµªå¾®åš">æ–°æµªå¾®åš</a>
    <a href="#" class="bds_tqq" data-cmd="tqq" title="åˆ†äº«åˆ°è…¾è®¯å¾®åš">è…¾è®¯å¾®åš</a>
    <a href="#" class="bds_renren" data-cmd="renren" title="åˆ†äº«åˆ°äººäººç½‘">äººäººç½‘</a>
    <a href="#" class="bds_weixin" data-cmd="weixin" title="åˆ†äº«åˆ°å¾®ä¿¡">å¾®ä¿¡</a>
</div>
<script>
window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"16"},"share":{"bdSize":16}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script>
<style>
    .bdshare_popup_box {
        border-radius: 4px;
        border: #e1e1e1 solid 1px;
    }
    .bdshare-button-style0-16 a,
    .bdshare-button-style0-16 .bds_more {
        padding-left: 20px;
        margin: 6px 10px 6px 0;
    }
    .bdshare_dialog_list a,
    .bdshare_popup_list a,
    .bdshare_popup_bottom a {
        font-family: 'Microsoft Yahei';
    }
    .bdshare_popup_top {
        display: none;
    }
    .bdshare_popup_bottom {
        height: auto;
        padding: 5px;
    }
</style>


</div>

            
    
        <a href="http://gangtieguo.cn/2018/09/06/DataFrame DataSet/#comments" class="article-comment-link">è¯„è®º</a>
    

        </footer>
    </div>
    
        
<nav id="article-nav">
    
    
        <a href="/2018/09/06/SparkSqlçš„ä½¿ç”¨/" id="article-nav-older" class="article-nav-link-wrap">
            <strong class="article-nav-caption">ä¸‹ä¸€ç¯‡</strong>
            <div class="article-nav-title">SparkSQLä½¿ç”¨</div>
        </a>
    
</nav>


    
</article>


    
    
        <section id="comments">
    <div id="lv-container" data-id="city" data-uid=MTAyMC8zNjM2MS8xMjg5Ng==></div>
</section>
    

</section>
            
            
        </div>
        <footer id="footer">

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol ==='https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2018 GTG<br>
            Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a><br>Analyse with <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1273739152'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s22.cnzz.com/z_stat.php%3Fid%3D1273739152%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>

<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1273739152'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s22.cnzz.com/z_stat.php%3Fid%3D1273739152%26online%3D1%26show%3Dline' type='text/javascript'%3E%3C/script%3E"));</script>
        </div>
    </div>
</footer>
        
    
    
    <!-- æ¥å¿…åŠ›Cityç‰ˆå®‰è£…ä»£ç  -->
    <script type="text/javascript">
     (function(d, s) {
         var j, e = d.getElementsByTagName(s)[0];

         if (typeof LivereTower === 'function') { return; }

         j = d.createElement(s);
         j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
         j.async = true;

         e.parentNode.insertBefore(j, e);
     })(document, 'script');
    </script>
  <noscript> ä¸ºæ­£å¸¸ä½¿ç”¨æ¥å¿…åŠ›è¯„è®ºåŠŸèƒ½è¯·æ¿€æ´»JavaScript</noscript>
  <!-- Cityç‰ˆå®‰è£…ä»£ç å·²å®Œæˆ -->





    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>